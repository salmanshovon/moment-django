<style>

    /* Container CSS */
    .custom-container {
        display: flex;
        flex-direction: row;
        align-items: stretch;
        justify-content: space-between; /* Distribute space evenly */
        width: 900px; /* Fixed width */
        /* border: 2px solid #838383;  */
        box-shadow: var(--shadow);
        border-radius: 15px; /* Rounded corners */
        overflow: hidden; /* Keeps children within border */
            /* background-color: transparent;  */
        background-color: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(7px) !important;
        border: solid 2px var(--primary-color);

        /* background-color: rgba(7, 7, 7, 0.1);
            backdrop-filter: blur(3px);
            border: solid 3px #666; */
            /* mask-image: linear-gradient(to left, rgb(255, 255, 255), rgb(255, 255, 255));
            -webkit-mask-image: linear-gradient(to left, rgba(0, 0, 0, 1), rgb(255, 255, 255)) */
    }

    .login-container {
        background-color: white;
        /* border-radius: 15px; */
        padding: 2rem 3rem;
        flex: 0 0 40%; /* Fixed 50% width, doesn't grow or shrink */
        /* max-width: 450px; */
        margin-right: -14px;
        margin-left: auto;
    }

    .login-title {
        font-weight: 400;
        color: var(--secondary-color) !important;
        color: var(--dark-color);
        margin-bottom: 1.25rem; /* Reduced */
        text-align: center;
        font-size: 1.5rem; /* Slightly larger for better hierarchy */
    }

    .form-control {
        padding: 0.65rem 1rem; /* Slightly reduced */
        border-radius: 8px;
        border: 1px solid #e0e0e0;
        transition: var(--transition);
        font-size: 0.95rem; /* Slightly smaller font */
    }

    .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.2rem rgba(67, 97, 238, 0.2); /* Slightly smaller shadow */
    }

    .btn-primary {
        background-color: var(--primary-color);
        border: none;
        padding: 0.65rem; /* Reduced */
        border-radius: 8px;
        font-weight: 600;
        transition: var(--transition);
        font-size: 0.95rem; /* Slightly smaller font */
    }

    .btn-google {
        background-color: white;
        color: #757575;
        border: 1px solid #e0e0e0;
        padding: 0.65rem; /* Reduced */
        border-radius: 8px;
        font-weight: 600;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px; /* Reduced */
        font-size: 0.95rem; /* Slightly smaller font */
    }

    .btn-google:hover {
        background-color: #f5f5f5;
        border-color: #d0d0d0;
    }

    .divider {
        display: flex;
        align-items: center;
        margin: 1.25rem 0; /* Reduced */
        color: #757575;
        font-size: 0.9rem; /* Slightly smaller */
    }

    .divider::before, .divider::after {
        content: "";
        flex: 1;
        border-bottom: 1px solid #e0e0e0;
    }

    .divider::before {
        margin-right: 1rem;
    }

    .divider::after {
        margin-left: 1rem;
    }

    .signup-link {
        text-align: center;
        text-decoration: none !important;
        margin-top: 1.25rem; /* Reduced */
        color: #757575;
        font-size: 0.95rem; /* Slightly smaller */
    }

    /* More compact form elements */
    .mb-3 {
        margin-bottom: 1rem !important; /* Reduced from 1.5rem */
    }

    .form-label {
        margin-bottom: 0.5rem; /* Reduced */
        font-size: 0.95rem; /* Slightly smaller */
    }


    @media (max-width: 1200px) {
        .login-container {
            padding:2rem 2rem;
            width:auto;
        }
    }

    @media (max-width: 767.8px) {
        .login-container {
            padding: 1.5rem 2rem;
            justify-self: center;
            margin: auto;              
        }
        
        .login-title {
            margin-bottom: 1rem;
            font-size: 2rem;
        }

        .custom-container {
            display: block;
            width: auto;
            height: auto;
            padding: 0;
            margin: 1rem 1rem;
            border: none;
            max-width: 85%;
        }
    }

</style>

<style>
.brand-sidebar {
    max-width: 80%;
    margin-left: 30px;
    padding-right: auto;
}




/* Responsive adjustments */
@media (max-width: 992px) {
    
    .brand-sidebar {
        padding: 0 2rem;
    }
}

.brand-text {
    font-size: 3.5rem; /* Slightly reduced for a more refined look */
    font-weight: 100; /* Semi-bold for a balance of impact and elegance */
    text-transform: uppercase;
    font-family: 'Raleway', sans-serif;
    letter-spacing: 2px; /* Reduced letter-spacing for a cleaner feel */
    color: #e8e8e8; /* Off-white for a softer contrast */

    /* Subtle Text Shadow */
    text-shadow: 1px 2px 5px rgba(0, 0, 0, 0.2);

    /* Refined Gradient Effect */
    background: linear-gradient(to right, #f0f0f0, #d0d0d0); /* More subtle gradient */
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;

    /* Adjusted Spacing and Rounded Corners */
    padding: 8px 16px; /* Slightly reduced padding */
    display: inline-block;
    border-radius: 8px; /* Slightly larger radius for a modern touch */
    
    /*Added a subtle border*/
    border: 1px solid rgba(255,255,255,0.1);
}

.text-back {
    font-weight: 100;
    font-size: 1.3rem;
    color:#a8a8a8;
}

#error-message, #success-message {
    font-size: 13px;
}

</style>


    <div class="container-fluid my-5">
        <div class="row justify-content-center align-items-center min-vh-50">

            <div class="custom-container">

                <!-- Branding Sidebar (Left) - Hidden on mobile -->
                <div class="col-lg-6 d-none d-md-flex align-items-center justify-content-center">
                    <div class="brand-sidebar text-center px-4">
                        <h3 class="text-back mb-2">Welcome Back to</h3>
                        <h4 class="mb-2 brand-text">MOMENT</h4>
                        <h2 class="fw-light fs-6 text-light" style="font-size: 0.8rem;">Master Your Time, Master Your Life</h2>
                        <hr class="my-3 border-light">
                        <p class="fst-italic text-light small">
                            "It is not that we have a short time to live, but that we waste much of it."
                            <br>
                            - Seneca
                        </p>
                    </div>
                </div>
                
                <!-- Login Container (Right) -->
                <!-- <div class="col-lg-4 col-md-8"> -->
                    <div class="login-container">
                        <h4 class="login-title">Sign In</h4>
                        
                        <form id="signin-form" method="post">
                            {% csrf_token %}
                            <div class="mb-3">
                                <label for="email" class="form-label">Username or Email</label>
                                <input type="text" class="form-control" id="email" name="username" placeholder="Enter your username or email" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="password" name="password" placeholder="Enter your password" required>
                                    <button class="btn btn-outline-secondary toggle-password" type="button">
                                        <i class="far fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <a href="{% url 'passreset' %}" class="text-decoration-none" style="font-size: 0.9rem;"
                                onclick="$(document).trigger('contentUpdated', [this.href, '#new-content', true]); return false;">Forgot password?</a>
                            </div>
                            
                            <!-- Error message container -->
                            <div id="error-message" class="alert alert-danger" style="display: none;"></div>
                            
                            {% if messages %}
                            <div id="success-message" class="alert alert-success">
                                {% for message in messages %}
                                    <p class="mb-0">{{ message }}</p>
                                {% endfor %}
                            </div>
                            <script>
                                // Hide message after a few seconds
                                setTimeout(function() {
                                    document.getElementById("success-message").style.display = "none";
                                }, 10000);
                            </script>
                            {% endif %}
                            
                            <button type="submit" class="btn btn-primary w-100 mb-1" id="signin-btn">Sign In</button>
                            
                            <div class="divider">or</div>
                            
                            {% load socialaccount %}
                            <a href="{% provider_login_url 'google' %}" class="btn btn-google w-100 mb-3">
                                <i class="fab fa-google"></i> Sign In with Google
                            </a>
                            
                            <div class="signup-link">
                                Don't have an account? <a href="{% url 'signup' %}"
                                onclick="$(document).trigger('contentUpdated', [this.href, '#new-content', true]); return false;">Sign Up</a>
                            </div>
                        </form>
                    </div>
                <!-- </div> -->

            </div>
        </div>
    </div>

    <script>
        function start_page() {
            // Password toggle functionality
            const togglePassword = document.querySelector('.toggle-password');
            const password = document.querySelector('#password');
            
            togglePassword.addEventListener('click', function() {
                // Toggle the type attribute
                const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
                password.setAttribute('type', type);
                
                // Toggle the eye icon
                this.querySelector('i').classList.toggle('fa-eye');
                this.querySelector('i').classList.toggle('fa-eye-slash');
                
                // Optional: Change button appearance when active
                this.classList.toggle('active');
            });
        
            // Form submission handling
            const form = document.getElementById("signin-form");
            const errorMessage = document.getElementById("error-message");
            const signInButton = document.getElementById("signin-btn");
        
            form.addEventListener("submit", function (event) {
                event.preventDefault();
        
                // Start loading state (you can add a spinner class if you want)
                signInButton.disabled = true;
                signInButton.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Signing In...';
        
                const formData = new FormData(form);
        
                fetch("{% url 'signin' %}", {
                    method: "POST",
                    body: formData,
                    headers: {
                        "X-CSRFToken": formData.get("csrfmiddlewaretoken"),
                        "X-Requested-With": "XMLHttpRequest"
                    }
                })
                .then(response => response.json())
                .then(data => {
                    // Reset button state
                    signInButton.disabled = false;
                    signInButton.textContent = "Sign In";
        
                    if (data.success) {
                        window.location.href = data.redirect_url;
                    } else {
                        errorMessage.textContent = data.error;
                        errorMessage.style.display = "block";
                        
                        // Hide error message after 5 seconds
                        setTimeout(function() {
                            errorMessage.style.display = "none";
                        }, 10000);
                    }
                })
                .catch(error => {
                    // Reset button state
                    signInButton.disabled = false;
                    signInButton.textContent = "Sign In";
        
                    console.error("Error:", error);
                    errorMessage.textContent = "An unexpected error occurred. Please try again.";
                    errorMessage.style.display = "block";
                    
                    // Hide error message after 5 seconds
                    setTimeout(function() {
                        errorMessage.style.display = "none";
                    }, 10000);
                });
            });
        };

        start_page();
        </script>

{% load static %}
<script src="{% static 'js/dash_check.js' %}"></script>